<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
    integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
    crossorigin="anonymous"></script>
</head>

<body>
  <nz-content>
    <nz-breadcrumb> </nz-breadcrumb>
    <div class="inner-content" style="margin-top: 15px;">

      <div nz-row style="margin-left: -25px;">

        <div nz-col nzSpan="6">
          <b>Cart</b><img src="assets/cartCheckout.png" />
        </div>

        <div nz-col nzSpan="4" nzOffset="9">

        </div>
      </div>



      <div class="sticky-container">
        <ul class="sticky">
          <li> <img width="32" height="32" title="User" alt="User" (click)="open()" src="assets/userImage.png"
              style="padding: 1px" />
            <p (click)="open()">Cashier</p>
          </li>
        </ul>
      </div>
      <nz-drawer [nzClosable]="false" [nzWidth]="250" [nzVisible]="visible" [nzPlacement]="placement"
        [nzTitle]="usernamee" (nzOnClose)="close()">

        <div style="text-align: center;">
          <nz-card style="width:200px;" nzTitle="Cash in hand" [nzExtra]="extraTemplate">

            <h5>

              <p> <i class="fa fa-money" aria-hidden="true"></i>
                {{totalamount}}</p>
            </h5>
          </nz-card>
        </div>
        <br>
        <div style="text-align: center;">
          <nz-card style="width:200px;" nzTitle="Total Transaction" [nzExtra]="extraTemplate">
            <h5>

              <p><i class="fa fa-line-chart" aria-hidden="true"></i> {{totalTrans}}</p>
            </h5>
          </nz-card>
        </div>
        <br>
        <div style="text-align: center;">
          <nz-card style="width:200px;" nzTitle="Last Login" [nzExtra]="extraTemplate">

            <h5>{{date}}</h5>
          </nz-card>
        </div>
        <div style="text-align:center; position:absolute; bottom:15px; margin-left: 30px">
          <button nz-button nzType="primary" nzDanger (click)="showConfirm()">Generate Reports</button>
        </div>
      </nz-drawer>
      <nz-modal [(nzVisible)]="isVisiblee" nzTitle="Products" (nzOnCancel)="handleCancell()" (nzOnOk)="handleOkk()">



        <div nz-row>
          <div nz-col nzXs="24" nzSm="24" nzMd="5" nzLg="7" nzXl="7" nzSpan="7" nzOffset="1"
            *ngFor="let p of tranByUser">
            <nz-card class="cardShadow" style="background-color:black" nzHoverable style="width:150px;margin-top:15px">
              <img [src]=p.product.image style="width:75px;height:75px">
              <hr>
              <b style="font-size:12px;padding:0px"> {{p.product.name | uppercase}}</b><br>
              <b style="font-size:10px;padding:0px">{{p.product.variants}} </b><br>
              <b style="font-size:12px;padding:0px">Quantity: {{p.quantity}} </b><br>

              <nz-tag style="margin-top:2px" [nzColor]="'#f50a0a'"> &#8360; {{p.amount}} </nz-tag>





            </nz-card>
          </div>
        </div>
      </nz-modal>

      <div  style="height: 390px; overflow-y: scroll;">

      <div *ngFor="let data of checkoutProductsArray; let i = index">
        <div nz-row style="margin-top: 5px;border-bottom: 2px black solid;" [ngClass]="{'checkoutClass':i==0}" (click)="showQuantityModal(data)">
          <div nz-col nzSpan="5">

            <div style="color: green; font-size: 20px; margin-top:10px">{{data.productQuantity}} x</div>


          </div>
          <div nz-col nzSpan="10" style="margin-top:4px; padding-bottom: 5px;">
            <div nz-row>
              <span style="font-size: 14px; font-weight: 500;">{{data.productTitle| uppercase}}</span>

            </div>
            <div nz-row>
              <span nz-col>{{data.printProductPrice}}</span>
          <span nz-col nzOffset="1">    <nz-tag style="height: 24px;" [nzColor]="'#f50'"> {{data.productVariant|uppercase}}</nz-tag></span>

            </div>


          </div>
          <div nz-col nzSpan="6" nzOffset="2">

            <div style="color: black; font-size: 20px; margin-top:10px; font-weight:500"> Rs {{data.productPrice}}
            </div>

          </div>



          <!-- <hr> -->

        </div>


      </div>
    </div>
      <hr style="color: black;" />
      <div nz-row>
        <div nz-col nzSpan="10" style="margin-top: 6px;">
          <div style="font-weight: 500;font-size: 20px;">
           Subtotal:
          </div>
        </div>

        <div nzOffset="6" nz-col nzSpan="8" style="margin-top: 6px;">
          <div style="font-weight: 500;font-size: 20px;">
           Rs {{ total ||0}}
          </div>
        </div>



      </div>
      <!-- <div nz-row>
        <div nz-col nzSpan="10" style="margin-top: 6px;">
          <div style="font-weight: 500;font-size: 15px;">
           (Discount)
          </div>
        </div>

        <div nzOffset="6" nz-col nzSpan="8" style="margin-top: 6px;">
          <div style="font-weight: 500;font-size: 20px;">
            {{ discount ||0}}
          </div>
        </div>



      </div> -->

      <!-- <div nz-row>
        <div nz-col nzSpan="10" style="margin-top: 6px;">
          <div style="font-weight: 500;font-size: 20px;">
           Grand Total:
          </div>
        </div>

        <div nzOffset="6" nz-col nzSpan="8" style="margin-top: 6px;">
          <div style="font-weight: 500;font-size: 20px;">
            {{ total ||0}}
          </div> </div>



      </div> -->
    </div>

    <div nz-row>
       <div nz-col nzSpan="10" style="margin-top: 6px;">
      <button [disabled]="checkoutProductsArray.length==0" (click)="addToPark()" style="background-color: #f2b80a;width: 100%;"
        nz-button>
        Add to Park
      </button>

    </div>
    <div nz-col nzSpan="10" nzOffset="2" style="margin-top: 6px; ">
      <button [disabled]="checkoutProductsArray.length==0" nz-button  (click)="showModal()" style="width: 100%; background-color: #ff4d4f;">
        Checkout
      </button></div>
</div>



  </nz-content>
  <nz-modal [(nzVisible)]="isVisible" nzTitle="Checkout" nzCancelText="Continue Shopping " (nzOnCancel)="handleCancel()"
    nzOkText="Checkout" (nzOnOk)="saveData('','SC')" [nzOkDisabled]="showError">


    <div style="margin-left: 10%;">
      <div style="text-align: right;">
        <b>Cost Price:</b><span nz-tooltip [(nzTooltipTitle)]="costPrice"><img style="height: 25px;"
            src="assets/suggestion.png"></span>
      </div>
      <div nz-row>
        <div nz-col nzSpan="10">
          <label class="label">Billing Amount:</label>
        </div>
        <div nz-col nzSpan="6" nzOffset="1">
          <input type="number" disabled="true" [(ngModel)]="total" class="inputStyle" />
        </div>
      </div>
      <div nz-row>
        <div nz-col nzSpan="10">
          <label class="label">Discount :</label>
        </div>
        <div nz-col nzSpan="6" nzOffset="1">
          <input type="number" [(ngModel)]="discountInRs" (input)="onDiscountChange()" min="0" class="inputStyle" />
        </div>
      </div>
      <div nz-row>
        <div nz-col nzSpan="10">
          <label class="label">Total Amount:</label>
        </div>
        <div nz-col nzSpan="6" nzOffset="1">
          <input type="number" [(ngModel)]="discountedAmount" disabled="true" class="inputStyle" />
        </div>
      </div>

      <div *ngIf="showError" class="alert alert-danger" role="alert">
        Discount can't be greater than billing amount!
      </div>
    </div>


  </nz-modal>
  <div id="print-section" [hidden]="true">
    <div style="text-align: center;">
      <img *ngIf="(chekingSetting && settingHeader   && settingHeader.logo  )" [src]="settingHeader.logo"
        style="height: 100px; width: 100px;">
    </div>
    <br>
    <div *ngIf="(chekingSetting && settingHeader  && settingHeader.header)"
      style="text-align: center; margin-bottom: 50px;">

      <h2 nz-title>{{settingHeader.header}}</h2>
    </div>

    <div class="container">


      <table class="table table-striped">
        <thead>
          <th *ngFor="let col of cols" style="text-align: center;">
            {{ col.header }}
            <hr style="border:1px solid black;width:100%;" />
          </th>
        </thead>
        <tbody>
          <tr *ngFor="let data of checkoutProductsArray" style="overflow: auto; ">
            <td>{{ data.productTitle }}</td>
            <td>{{ data.printProductPrice }}</td>
            <td>{{ data.productQuantity }}</td>
            <td>{{ data.productPrice }}</td>
          </tr>
        </tbody>
      </table>
      <div>
        <hr style="border:1px solid black;width:100%;" />
        <span><b> Billing Amount: </b> <span style="margin-left:83%;margin-top: -10%">{{ total }}</span></span>
        <span><b> Discount: </b> <span style="margin-left:83%;">{{ discountInRs }}</span></span>
        <span><b> Total: </b> <span style="margin-left:83%;">{{ discountedAmount }}</span></span>
        <hr style="border:1px solid black;width:100%;" />
      </div>
    </div>


    <div *ngIf=" (chekingSetting && settingHeader  && settingHeader.footer  != 'undefined')"
      style="text-align: center; margin-top: 70px;">

      <h2 nz-title>{{settingHeader.footer}}</h2>

    </div>
    <small style="margin-left: 25%">Powered by Stepway</small>
    <br>
    <small style="margin-left: 25%">contact 0332 2078369</small>
  </div>
  <button id="print-slip-btn" hidden="true" printSectionId="print-section" ngxPrint>print</button>
</body>

<nz-modal [(nzVisible)]="isCheckoutModalVisible" [nzClosable]="false" [nzFooter]=null (nzOnCancel)="handleCheckoutModalCancel()" (nzOnOk)="handleCheckoutModalOk()">
<div style="border-bottom: 2px solid black;
padding-bottom: 8px;"   nz-row nzJustify="space-between">
<div  nz-col nzSpan="7">
  <button (click)="removeProductFromCheckout()"  nz-button nzType="danger" nzDanger>Remove</button>
</div>
<div  nz-col nzOffset="1" nzSpan="9"><h6>{{currentProduct.productTitle}}</h6></div>
<div  nz-col nzOffset="3" nzSpan="4">
<button (click)="updateQuantity()" nz-button style="color:white; background-color:rgb(98, 221, 15)">Update</button>
</div>


  </div>

  <div   class="container" style="margin-top: 10px;; box-shadow: 5px 5px 5px 5px grey; padding: 10px;">
    <div class="row" style="  margin-left: 50px;">

      <div class="col-lg-12">
    <div class="form-check-inline">
    <button class="btn btn-primary" (click)="plus()"><i class="fa fa-plus"></i></button>
    </div>
    <div class="form-check-inline">
    <input style="text-align: center;" type="text" class="form-control" [(ngModel)]="inputnumber">
    </div>
    <div class="form-check-inline">
    <button class="btn btn-primary" (click)="minus()"><i class="fa fa-minus"></i></button>
    </div>

      </div>
    </div>

  </div>
<div style="margin-top: 20px;; box-shadow: 5px 5px 5px 5px grey; padding: 10px;">
  <div nz-row  >
    <div nz-row style="text-align: center; font-size: 15px;">    <span nz-typography nzType="success"><strong>FREE OR GIFT ( PRICE = 0) </strong></span></div>
    <div class="flex-container space-around" style="margin-top:10px">
    <div class="form-check form-check-inline flex-item">
      <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="Free" (change)="isFreeFunction()" [(ngModel)]="isFree">
      <label style="margin-left: 10px;
      font-size: 15px;
      font-weight: 700;" class="form-check-label" for="inlineCheckbox1">Give as Free</label>
    </div>
    <div class="form-check form-check-inline flex-item">
      <input class="form-check-input" type="checkbox" name="" id="inlineCheckbox1" value="Gift" [(ngModel)]="isGift">
      <label style="margin-left: 10px;
      font-size: 15px;
      font-weight: 700;" class="form-check-label" for="inlineCheckbox2">Give as a Gift</label>
    </div>

  </div>

  </div>
</div>
</nz-modal>
</html>
